function dynamicLineInit(){$("div[data-toggle=fieldset]").each(function(){dynamicLineEvent($(this))})}function dynamicLineEvent(t){var e=t;e.find("[data-toggle=fieldset-add-row]").on("click",function(){var t=$($(this).data("target"));e.trigger("rowadded",addRow(t))}),e.find("[data-toggle=fieldset-remove-row]").on("click",function(){e.find("[data-toggle=fieldset-entry]").length>1&&$(this).closest("[data-toggle=fieldset-entry]").remove()}),e.find("[data-toggle=fieldset-clear-all]").on("click",function(){clearContent($($(this).data("target")))}),e.find("[data-toggle=fieldset-up-row]").click(function(){var t=$(this).closest("[data-toggle=fieldset-entry]");exchangeRow(t,t.prevAll(":visible:first"))}),e.find("[data-toggle=fieldset-down-row]").click(function(){var t=$(this).closest("[data-toggle=fieldset-entry]");exchangeRow(t.nextAll(":visible:first"),t)})}function addRow(t){var e=t.attr("id").slice(0,-9),i=t.find("[data-toggle=fieldset-entry]:last"),n={};i.find("select").each(function(){$(this)[0].selectize&&(n[$(this).attr("id")]={options:$(this)[0].selectize.options,value:$(this)[0].selectize.getValue()},$(this)[0].selectize.destroy())});var a=i.clone(!0,!0),d=a.find(":input")[0].id,r=new RegExp(e+".*-(\\d{1,4})-.*","m"),l=parseInt(d.replace(r,"$1"))+1;return a.removeAttr("style"),a.find(":input").each(function(){var t=new RegExp(e+"(.*-)\\d{1,4}(-.*)","m"),i=$(this).attr("id").replace(t,e+"$1"+l+"$2");$(this).attr("name",i).attr("id",i),$(this).is(":checkbox")?$(this).prop("checked",!1):$(this).val("")}),a.find("a").each(function(){$(this).attr("href")&&$(this).attr("href","#"),$(this).attr("onclick")&&$(this).attr("onclick","")}),a.find("button").each(function(){$(this).attr("onclick")&&$(this).attr("onclick","")}),$(".ignore",a).remove(),i.after(a),{new_row:a,old_row:i,selectize_elements:n}}function clearContent(t){t.find("[data-toggle=fieldset-entry]:visible").find(":input").each(function(){$(this).val("")})}function exchangeRow(t,e){if("TR"==t.prop("tagName")&&"TR"==e.prop("tagName")&&t.children("td").length==e.children("td").length)for(t.after(e),i=0;i<t.children("td").length;i++){var n=t.children("td").eq(i).children(":first"),a=e.children("td").eq(i).children(":first"),d=n.attr("id"),r=a.attr("id");d&&r&&(n.attr("id",r),a.attr("id",d));var l=n.attr("name"),c=a.attr("name");l&&c&&(n.attr("name",c),a.attr("name",l))}}